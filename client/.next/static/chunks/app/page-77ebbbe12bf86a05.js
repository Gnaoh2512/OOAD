(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{239:(e,t,n)=>{"use strict";n.d(t,{AuthProvider:()=>s,A:()=>c});var a=n(5155),i=n(2115),r=n(8999),o=n(485);let l=(0,i.createContext)(void 0);function s(e){let{children:t}=e,[n,s]=(0,i.useState)(null),[c,d]=(0,i.useState)(!0),u=(0,r.useRouter)(),p=async()=>{try{await (0,o.A)("".concat("http://localhost:5000","/auth/logout"),{method:"POST"})}finally{s(null),u.push("/auth")}};return(0,i.useEffect)(()=>{(async()=>{try{let e=await (0,o.A)("".concat("http://localhost:5000","/auth/profile"));e?s({user_id:e.id,user_name:e.user_name,email:e.email}):s(null)}finally{d(!1)}})()},[]),(0,i.useEffect)(()=>{c||n||u.push("/auth")},[c,n,u]),(0,a.jsx)(l.Provider,{value:{user:n,loading:c,logout:p},children:t})}let c=()=>{let e=(0,i.useContext)(l);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},485:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});let a=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{method:n="GET",body:a,headers:i={},responseType:r="json"}=t,o={method:n,headers:{"Content-Type":"application/json",...i},...a&&{body:JSON.stringify(a)},credentials:"include"},l=await fetch(e,o);if(!l.ok)throw Error("Failed to fetch: ".concat(l.statusText));if("text"===r)return l.text();let s=await l.text();return s?JSON.parse(s):{}}},570:(e,t,n)=>{var a=n(4376),i=Object.prototype,r=i.hasOwnProperty,o=i.toString,l=a?a.toStringTag:void 0;e.exports=function(e){var t=r.call(e,l),n=e[l];try{e[l]=void 0;var a=!0}catch(e){}var i=o.call(e);return a&&(t?e[l]=n:delete e[l]),i}},771:(e,t,n)=>{var a=n(8233),i=n(8611);e.exports=function(e){return"symbol"==typeof e||i(e)&&"[object Symbol]"==a(e)}},1959:(e,t,n)=>{var a=n(5964),i=n(7460);e.exports=function(e,t,n){var r=!0,o=!0;if("function"!=typeof e)throw TypeError("Expected a function");return i(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),a(e,t,{leading:r,maxWait:t,trailing:o})}},1980:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>C});var a=n(5155),i=n(2115),r=n(239),o=n(6572),l=n.n(o),s=n(4649),c=n.n(s),d=n(485);let u=e=>{let t=e.getFullYear(),n=(e.getMonth()+1).toString().padStart(2,"0"),a=e.getDate().toString().padStart(2,"0"),i=e.getHours().toString().padStart(2,"0"),r=e.getMinutes().toString().padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(a," ").concat(i,":").concat(r,":00")},p=(e,t)=>{let n=t.replace(/\D/g,"").slice(0,2);e(e=>({...e,hour:n}))},m=(e,t)=>{let n=t?Math.min(23,Math.max(0,parseInt(t))):9;e(e=>({...e,hour:n.toString().padStart(2,"0")}))},h=(e,t)=>{let n=t.replace(/\D/g,"").slice(0,2);e(e=>({...e,minute:n}))},_=(e,t)=>{let n=t?Math.min(59,Math.max(0,parseInt(t))):0;e(e=>({...e,minute:n.toString().padStart(2,"0")}))},g=function(e){let{selectedDate:t,onClose:n,showModal:r,appointment:o=null}=e,[l,s]=(0,i.useState)(""),[g,x]=(0,i.useState)(""),[v,f]=(0,i.useState)({hour:"09",minute:"00"}),[j,S]=(0,i.useState)({hour:"17",minute:"00"}),[y,b]=(0,i.useState)(!1);(0,i.useEffect)(()=>{if(o){s(o.appointment_name||""),x(o.location||"");let e=new Date(o.start_time),t=new Date(o.end_time);f({hour:e.getHours().toString().padStart(2,"0"),minute:e.getMinutes().toString().padStart(2,"0")}),S({hour:t.getHours().toString().padStart(2,"0"),minute:t.getMinutes().toString().padStart(2,"0")}),b(o.host.remind||!1)}else s(""),x(""),f({hour:"09",minute:"00"}),S({hour:"17",minute:"00"}),b(!1)},[o,r]);let N=()=>{if(!l.trim())return alert("Title is required."),!1;if(!g.trim())return alert("Location is required."),!1;let e=t||(o?new Date(o.start_time):null);if(!e)return alert("No date selected."),!1;let n=new Date(e);n.setHours(parseInt(v.hour),parseInt(v.minute),0);let a=new Date(e);return a.setHours(parseInt(j.hour),parseInt(j.minute),0),!(n>=a)||(alert("Start time must be before end time."),!1)},C=async()=>{let e,a;if(!N())return;if(t)e=new Date(t),a=new Date(t),e.setHours(Number(v.hour),Number(v.minute),0),a.setHours(Number(j.hour),Number(j.minute),0);else{if(!o)return void alert("No date available.");e=new Date(o.start_time),a=new Date(o.end_time),e.setHours(Number(v.hour),Number(v.minute),0),a.setHours(Number(j.hour),Number(j.minute),0)}let i={name:l,location:g,start:u(e),end:u(a),remind:y},r=!!(null==o?void 0:o.appointment_id),s=r?"".concat("http://localhost:5000","/user/appointments/").concat(null==o?void 0:o.appointment_id):"".concat("http://localhost:5000","/user/appointments"),c=await (0,d.A)(s,{method:r?"PUT":"POST",body:i});alert(c.message),"success"===c.status&&n()};return(0,a.jsx)("div",{className:"".concat(c().modalOverlay," ").concat(r?c().display:""),children:(0,a.jsxs)("div",{className:c().modal,children:[(0,a.jsx)("button",{onClick:n,className:c().modalClose,children:"\xd7"}),(0,a.jsx)("h4",{children:o?"Edit Appointment":"Add Appointment"}),(0,a.jsxs)("p",{children:["Date: ",null==t?void 0:t.toDateString()]}),(0,a.jsxs)("label",{children:["Title:",(0,a.jsx)("input",{type:"text",value:l,onChange:e=>s(e.target.value),placeholder:"Appointment title"})]}),(0,a.jsxs)("label",{children:["Location:",(0,a.jsx)("input",{type:"text",value:g,onChange:e=>x(e.target.value),placeholder:"Location"})]}),(0,a.jsxs)("label",{children:["Start Time:",(0,a.jsxs)("div",{className:c().time,children:[(0,a.jsx)("input",{type:"text",value:v.hour,onChange:e=>p(f,e.target.value),onBlur:()=>m(f,v.hour),maxLength:2}),":",(0,a.jsx)("input",{type:"text",value:v.minute,onChange:e=>h(f,e.target.value),onBlur:()=>_(f,v.minute),maxLength:2})]})]}),(0,a.jsxs)("label",{children:["End Time:",(0,a.jsxs)("div",{className:c().time,children:[(0,a.jsx)("input",{type:"text",value:j.hour,onChange:e=>p(S,e.target.value),onBlur:()=>m(S,j.hour),maxLength:2}),":",(0,a.jsx)("input",{type:"text",value:j.minute,onChange:e=>h(S,e.target.value),onBlur:()=>_(S,j.minute),maxLength:2})]})]}),(0,a.jsxs)("label",{className:c().remindLabel,children:[(0,a.jsx)("span",{children:"Remind me"}),(0,a.jsx)("button",{type:"button",onClick:()=>b(e=>!e),className:"".concat(c().toggleRemind," ").concat(y?c().active:""),"aria-pressed":y,children:y?"Yes":"No"})]}),(0,a.jsx)("button",{className:c().saveBtn,onClick:C,children:o?"Update":"Add"})]})})};var x=n(8102),v=n.n(x);function f(e){var t,n;let{appointment:o,showDetail:l,onClose:s}=e,{user:c}=(0,r.A)(),[u,p]=(0,i.useState)(!1),m=(null==c?void 0:c.user_id)===(null==o?void 0:o.host.user_id),h=async()=>{var e;let t=null==o||null==(e=o.participants)?void 0:e.some(e=>e.user_id===(null==c?void 0:c.user_id));alert((await (0,d.A)("".concat("http://localhost:5000","/user/appointments/").concat(null==o?void 0:o.appointment_id,"/join"),{method:t?"PUT":"POST",...t?{}:{body:{remind:!0}}})).message)},_=async()=>{if(o&&confirm("Are you sure you want to delete this appointment?"))try{let e=await (0,d.A)("".concat("http://localhost:5000","/user/appointments/").concat(o.appointment_id),{method:"DELETE"});alert(e.message),e.message.toLowerCase().includes("success")&&s()}catch(e){alert(e)}};return(0,a.jsx)("div",{className:"".concat(v().backdrop," ").concat(l?v().display:""),onClick:s,children:(0,a.jsxs)("div",{className:v().modal,onClick:e=>e.stopPropagation(),children:[(0,a.jsx)("button",{className:v().closeBtn,onClick:s,children:"\xd7"}),(0,a.jsx)("h2",{children:null==o?void 0:o.appointment_name}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Time:"})," ",(null==o?void 0:o.start_time)?new Date(o.start_time).toLocaleString():""," - ",(null==o?void 0:o.end_time)?new Date(o.end_time).toLocaleString():""]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Host:"})," ",null==o?void 0:o.host.user_name]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Location:"})," ",null==o?void 0:o.location]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Participants:"})," ",(null==o?void 0:o.participants)&&o.participants.length>0?o.participants.map(e=>e.user_name).join(", "):"No participant"]}),(0,a.jsx)("div",{className:v().btnContainer,children:m?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{className:v().dynamicBtn,onClick:()=>p(!0),children:"Edit Appointment"}),(0,a.jsx)("button",{className:v().dynamicBtn,style:{backgroundColor:"red",marginLeft:"10px"},onClick:_,children:"Delete Appointment"})]}):(0,a.jsx)("button",{className:v().dynamicBtn,onClick:h,children:(null==o||null==(t=o.participants)?void 0:t.some(e=>e.user_id===(null==c?void 0:c.user_id)))?(null==(n=o.participants.find(e=>e.user_id===(null==c?void 0:c.user_id)))?void 0:n.remind)?"Turn off reminder":"Turn on reminder":"Join Group Meeting"})}),(0,a.jsx)(g,{appointment:o,showModal:u,onClose:()=>p(!1)})]})})}function j(e){let{selectedDate:t,showSidePanel:n,setShowSidePanel:r}=e,[o,l]=(0,i.useState)(null),[s,u]=(0,i.useState)(null),[p,m]=(0,i.useState)(!1),[h,_]=(0,i.useState)(!1),[x,v]=(0,i.useState)(!1);(0,i.useEffect)(()=>{(async()=>{if(!t)return;let e="".concat(t.getFullYear(),"-").concat(String(t.getMonth()+1).padStart(2,"0"),"-").concat(String(t.getDate()).padStart(2,"0"));v(!0);try{let t=await (0,d.A)("".concat("http://localhost:5000","/data/").concat(e));l(t)}finally{v(!1)}})()},[t]);let j=e=>{u(e),_(!0)};return(0,a.jsxs)("div",{className:"".concat(c().panel," ").concat(n?c().expand:""),children:[(0,a.jsx)("button",{className:c().closeBtn,onClick:()=>r(!1),children:"\xd7"}),(0,a.jsx)("h3",{children:"Selected Date"}),(0,a.jsx)("p",{children:null==t?void 0:t.toDateString()}),(0,a.jsx)("button",{className:c().addBtn,onClick:()=>m(!0),children:"Add Appointment"}),x?(0,a.jsx)("p",{children:"Loading..."}):o?0===o.length?(0,a.jsx)("p",{children:"No appointments for this date."}):(0,a.jsx)("ul",{className:c().appointmentList,children:o.map(e=>(0,a.jsxs)("li",{className:c().appointmentItem,onClick:()=>j(e),children:[(0,a.jsx)("h4",{children:e.appointment_name}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Time:"})," ",new Date(e.start_time).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})," ","-"," ",new Date(e.end_time).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Host:"})," ",e.host.user_name]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Location:"})," ",e.location]})]},e.appointment_id))}):null,(0,a.jsx)(g,{selectedDate:t,showModal:p,onClose:()=>m(!1)}),(0,a.jsx)(f,{appointment:s,showDetail:h,onClose:()=>_(!1)})]})}var S=n(1959),y=n.n(S);let b=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],N=function(){let e=new Date,[t,n]=(0,i.useState)(new Date(e.getFullYear(),e.getMonth(),1)),[o,s]=(0,i.useState)(null),[c,d]=(0,i.useState)(!1),{logout:u}=(0,r.A)(),p=t.getFullYear(),m=t.getMonth(),h=new Date(p,m+1,0).getDate(),_=new Date(p,m,1).getDay(),g=(0,i.useRef)(y()(e=>{s(new Date(p,m,e)),d(!0)},1e3)).current,x=e=>{g(e)},v=Array(_).fill(null).concat([...Array(h).keys()].map(e=>e+1));return(0,a.jsxs)("div",{className:"".concat(l().container," ").concat(c?l().expand:""),children:[(0,a.jsx)("button",{className:l().logoutBtn,onClick:u,children:"Log out"}),(0,a.jsxs)("div",{className:l().calendar,children:[(0,a.jsxs)("div",{className:l().header,children:[(0,a.jsx)("button",{onClick:()=>{n(new Date(p,m-1,1))},children:"←"}),(0,a.jsxs)("h2",{children:[t.toLocaleString("en-US",{month:"long"})," ",p]}),(0,a.jsx)("button",{onClick:()=>{n(new Date(p,m+1,1))},children:"→"})]}),(0,a.jsxs)("div",{className:l().grid,children:[b.map(e=>(0,a.jsx)("div",{className:l().dayName,children:e},e)),v.map((t,n)=>{let i=t===e.getDate()&&m===e.getMonth()&&p===e.getFullYear(),r=o&&t===o.getDate()&&m===o.getMonth()&&p===o.getFullYear(),s=t?new Date(p,m,t).toISOString().split("T")[0]:"",c=null===t;return(0,a.jsx)("div",{className:"".concat(l().dayCell," ").concat(i?l().today:""," ").concat(r?l().selected:""," ").concat(c?l().hide:""),"data-date":s,onClick:()=>t&&x(t),children:null!=t?t:""},n)})]})]}),(0,a.jsx)(j,{selectedDate:o,showSidePanel:c,setShowSidePanel:d})]})};function C(){let{user:e}=(0,r.A)();return e?(0,a.jsx)(N,{}):(0,a.jsx)("div",{children:"unauthorized"})}},2500:(e,t,n)=>{var a=n(7985),i="object"==typeof self&&self&&self.Object===Object&&self;e.exports=a||i||Function("return this")()},4217:(e,t,n)=>{var a=n(6713),i=/^\s+/;e.exports=function(e){return e?e.slice(0,a(e)+1).replace(i,""):e}},4376:(e,t,n)=>{e.exports=n(2500).Symbol},4439:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},4649:e=>{e.exports={panel:"SidePanel_panel__565vh",expand:"SidePanel_expand__m_8Nc",closeBtn:"SidePanel_closeBtn__aXjCq",addBtn:"SidePanel_addBtn__PvRPo",modalOverlay:"SidePanel_modalOverlay__ImIgP",display:"SidePanel_display__RVuJU",modal:"SidePanel_modal__9N_8e",time:"SidePanel_time__NSX2X",remindLabel:"SidePanel_remindLabel__yVgvG",modalClose:"SidePanel_modalClose__MTkNF",saveBtn:"SidePanel_saveBtn__j9WfW",appointmentList:"SidePanel_appointmentList__o07Hi",appointmentItem:"SidePanel_appointmentItem__y7Y_A"}},5964:(e,t,n)=>{var a=n(7460),i=n(6685),r=n(6815),o=Math.max,l=Math.min;e.exports=function(e,t,n){var s,c,d,u,p,m,h=0,_=!1,g=!1,x=!0;if("function"!=typeof e)throw TypeError("Expected a function");function v(t){var n=s,a=c;return s=c=void 0,h=t,u=e.apply(a,n)}function f(e){var n=e-m,a=e-h;return void 0===m||n>=t||n<0||g&&a>=d}function j(){var e,n,a,r=i();if(f(r))return S(r);p=setTimeout(j,(e=r-m,n=r-h,a=t-e,g?l(a,d-n):a))}function S(e){return(p=void 0,x&&s)?v(e):(s=c=void 0,u)}function y(){var e,n=i(),a=f(n);if(s=arguments,c=this,m=n,a){if(void 0===p)return h=e=m,p=setTimeout(j,t),_?v(e):u;if(g)return clearTimeout(p),p=setTimeout(j,t),v(m)}return void 0===p&&(p=setTimeout(j,t)),u}return t=r(t)||0,a(n)&&(_=!!n.leading,d=(g="maxWait"in n)?o(r(n.maxWait)||0,t):d,x="trailing"in n?!!n.trailing:x),y.cancel=function(){void 0!==p&&clearTimeout(p),h=0,s=m=c=p=void 0},y.flush=function(){return void 0===p?u:S(i())},y}},6572:e=>{e.exports={container:"Calendar_container__ePOV_",expand:"Calendar_expand__NU8sV",calendar:"Calendar_calendar__a_nVX",header:"Calendar_header__yWVzT",grid:"Calendar_grid__4EhWr",dayName:"Calendar_dayName__cFNHP",dayCell:"Calendar_dayCell__idCoe",hide:"Calendar_hide__1wbfS",today:"Calendar_today__fNYWo",selected:"Calendar_selected__8iU5Z",logoutBtn:"Calendar_logoutBtn__FUGez"}},6685:(e,t,n)=>{var a=n(2500);e.exports=function(){return a.Date.now()}},6713:e=>{var t=/\s/;e.exports=function(e){for(var n=e.length;n--&&t.test(e.charAt(n)););return n}},6815:(e,t,n)=>{var a=n(4217),i=n(7460),r=n(771),o=0/0,l=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,c=/^0o[0-7]+$/i,d=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(r(e))return o;if(i(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=i(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=a(e);var n=s.test(e);return n||c.test(e)?d(e.slice(2),n?2:8):l.test(e)?o:+e}},7460:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},7985:(e,t,n)=>{e.exports="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g},8102:e=>{e.exports={backdrop:"AppointmentDetailsModal_backdrop__VmCDm",display:"AppointmentDetailsModal_display__52Ac_",modal:"AppointmentDetailsModal_modal__E28Wp",closeBtn:"AppointmentDetailsModal_closeBtn__W90yE",btnContainer:"AppointmentDetailsModal_btnContainer__hqV3j"}},8233:(e,t,n)=>{var a=n(4376),i=n(570),r=n(4439),o=a?a.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":o&&o in Object(e)?i(e):r(e)}},8611:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},9515:(e,t,n)=>{Promise.resolve().then(n.bind(n,1980))}},e=>{var t=t=>e(e.s=t);e.O(0,[360,441,684,358],()=>t(9515)),_N_E=e.O()}]);